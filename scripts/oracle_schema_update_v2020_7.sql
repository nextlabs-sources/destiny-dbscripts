UPDATE SYS_CONFIG SET VALUE = 'https://docs.nextlabs.com/cc/2020.07' WHERE APPLICATION = 'application' AND CONFIG_KEY = 'help.url.base';
UPDATE SYS_CONFIG SET VALUE = 'unique_name', DEFAULT_VALUE = 'unique_name' WHERE CONFIG_KEY LIKE 'cas.authn.pac4j.oidc[%].principalAttributeId' AND VALUE = 'upn';
DELETE FROM SYS_CONFIG WHERE CONFIG_KEY = 'context.parameter.EnforcePasswordHistory';

INSERT INTO SYS_CONFIG (ID, APPLICATION, CONFIG_KEY, VALUE, DEFAULT_VALUE, VALUE_FORMAT, MAIN_GROUP, SUB_GROUP, MAIN_GROUP_ORDER, SUB_GROUP_ORDER, CONFIG_ORDER, HIDDEN, READ_ONLY, ADVANCED, UI, ENCRYPTED, RESTART_REQUIRED, DATA_TYPE, FIELD_TYPE, OPTIONS, REQUIRED, PATTERN, DESCRIPTION, MODIFIED_ON, MODIFIED_BY) VALUES (HIBERNATE_SEQUENCE.NEXTVAL, 'console', 'dashboard.widget.refresh.interval', '30', '30', '', 'reporter', 'console.dashboard', '65', '10', '110', '0', '0', '1', '1', '0', '0', 'integer', 'number', '', '1', '^[0-9]+$', 'Refresh interval of Dashboard system configuration status and recent activities, in seconds.', CURRENT_TIMESTAMP, '-1');

INSERT INTO ACCESS_CONTROL (ID, REQUEST_METHOD, URL_PATTERN, EXPRESSION) VALUES (HIBERNATE_SEQUENCE.NEXTVAL, 'POST', '/api/v1/secureStore/replaceStoreFile', 'hasAuthority(''MANAGE_SECURE_STORE'')');

UPDATE SYS_CONFIG SET VALUE = '9200', DEFAULT_VALUE = '9200' WHERE APPLICATION = 'console' AND CONFIG_KEY = 'search.engine.port';

INSERT INTO SYS_CONFIG (ID, APPLICATION, CONFIG_KEY, VALUE, DEFAULT_VALUE, VALUE_FORMAT, MAIN_GROUP, SUB_GROUP, MAIN_GROUP_ORDER, SUB_GROUP_ORDER, CONFIG_ORDER, HIDDEN, READ_ONLY, ADVANCED, UI, ENCRYPTED, RESTART_REQUIRED, DATA_TYPE, FIELD_TYPE, OPTIONS, REQUIRED, PATTERN, DESCRIPTION, MODIFIED_ON, MODIFIED_BY) VALUES (HIBERNATE_SEQUENCE.NEXTVAL, 'dms', 'dac.index.rebuild.days.of.month', '', '', '', 'dac', 'index', '80', '0', '4', '0', '0', '0', '0', '0', '1', 'text', 'text', '', '0', '', 'Comma separated list of days of the month on which to run sync operations (e.g. 1,2,3)', CURRENT_TIMESTAMP, '-1');
UPDATE SYS_CONFIG SET CONFIG_ORDER = '5' WHERE CONFIG_KEY = 'dac.index.rebuild.timeout.minutes';

DECLARE
  string20_exists number := 0&semi 
  column_type varchar(10)&semi
BEGIN
  Select count(*) into string20_exists 
  from user_tab_cols
  where upper(column_name) = 'STRING20'
  and upper(table_name) = 'DICT_LEAF_ELEMENTS'&semi
  
  select value into column_type FROM v$parameter WHERE name = 'max_string_size'&semi
  
  if(column_type = 'STANDARD') then
    if (string20_exists = 0) then
        execute immediate 'ALTER TABLE DICT_LEAF_ELEMENTS ADD 
        (STRING20 VARCHAR2(4000), STRING21 VARCHAR2(4000), STRING22 VARCHAR2(4000), STRING23 VARCHAR2(4000), STRING24 VARCHAR2(4000),
		STRING25 VARCHAR2(4000), STRING26 VARCHAR2(4000), STRING27 VARCHAR2(4000), STRING28 VARCHAR2(4000),STRING29 VARCHAR2(4000),
		STRING30 VARCHAR2(4000), STRING31 VARCHAR2(4000), STRING32 VARCHAR2(4000), STRING33 VARCHAR2(4000),STRING34 VARCHAR2(4000),
		STRING35 VARCHAR2(4000), STRING36 VARCHAR2(4000), STRING37 VARCHAR2(4000), STRING38 VARCHAR2(4000),STRING39 VARCHAR2(4000),
		STRING40 VARCHAR2(4000), STRING41 VARCHAR2(4000), STRING42 VARCHAR2(4000), STRING43 VARCHAR2(4000),STRING44 VARCHAR2(4000),
		STRING45 VARCHAR2(4000), STRING46 VARCHAR2(4000), STRING47 VARCHAR2(4000), STRING48 VARCHAR2(4000),STRING49 VARCHAR2(4000))'&semi
    end if&semi
  else
    if (string20_exists = 0) then
        execute immediate 'ALTER TABLE DICT_LEAF_ELEMENTS ADD
       (STRING20 VARCHAR2(32767), STRING21 VARCHAR2(32767), STRING22 VARCHAR2(32767), STRING23 VARCHAR2(32767), STRING24 VARCHAR2(32767),
		STRING25 VARCHAR2(32767), STRING26 VARCHAR2(32767), STRING27 VARCHAR2(32767), STRING28 VARCHAR2(32767),STRING29 VARCHAR2(32767),
		STRING30 VARCHAR2(32767), STRING31 VARCHAR2(32767), STRING32 VARCHAR2(32767), STRING33 VARCHAR2(32767),STRING34 VARCHAR2(32767),
		STRING35 VARCHAR2(32767), STRING36 VARCHAR2(32767), STRING37 VARCHAR2(32767), STRING38 VARCHAR2(32767),STRING39 VARCHAR2(32767),
		STRING40 VARCHAR2(32767), STRING41 VARCHAR2(32767), STRING42 VARCHAR2(32767), STRING43 VARCHAR2(32767),STRING44 VARCHAR2(32767),
		STRING45 VARCHAR2(32767), STRING46 VARCHAR2(32767), STRING47 VARCHAR2(32767), STRING48 VARCHAR2(32767),STRING49 VARCHAR2(32767))'&semi
    else
        execute immediate 'ALTER TABLE DICT_LEAF_ELEMENTS MODIFY
       (STRING20 VARCHAR2(32767), STRING21 VARCHAR2(32767), STRING22 VARCHAR2(32767), STRING23 VARCHAR2(32767), STRING24 VARCHAR2(32767),
		STRING25 VARCHAR2(32767), STRING26 VARCHAR2(32767), STRING27 VARCHAR2(32767), STRING28 VARCHAR2(32767),STRING29 VARCHAR2(32767),
		STRING30 VARCHAR2(32767), STRING31 VARCHAR2(32767), STRING32 VARCHAR2(32767), STRING33 VARCHAR2(32767),STRING34 VARCHAR2(32767),
		STRING35 VARCHAR2(32767), STRING36 VARCHAR2(32767), STRING37 VARCHAR2(32767), STRING38 VARCHAR2(32767),STRING39 VARCHAR2(32767),
		STRING40 VARCHAR2(32767), STRING41 VARCHAR2(32767), STRING42 VARCHAR2(32767), STRING43 VARCHAR2(32767),STRING44 VARCHAR2(32767),
		STRING45 VARCHAR2(32767), STRING46 VARCHAR2(32767), STRING47 VARCHAR2(32767), STRING48 VARCHAR2(32767),STRING49 VARCHAR2(32767))'&semi
    end if&semi
  end if&semi
end&semi;

UPDATE SYS_CONFIG SET HIDDEN = '1' WHERE CONFIG_KEY = 'dac.index.rebuild.days.of.month';
