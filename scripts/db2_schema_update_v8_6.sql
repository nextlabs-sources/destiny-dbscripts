CREATE TABLE PASSWORD_HISTORY(
  ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (  
		    START WITH +1  
		    INCREMENT BY +1  
		    MINVALUE +1  
		    MAXVALUE +9223372036854775807  
		    NO CYCLE  
		    CACHE 20  
		    NO ORDER ),
  USER_ID NUMERIC(19,0) NOT NULL,
  PASSWORD VARBINARY(256) NOT NULL,
  TIMESTAMP NUMERIC(19,0) NOT NULL,
  CONSTRAINT PASSWORD_HISTORY_PK PRIMARY KEY(
    ID
  ) 
);

CREATE INDEX IDX_PASSWORD_HISTORY_4_USER
ON PASSWORD_HISTORY (
	USER_ID ASC, TIMESTAMP DESC
);

CREATE TABLE ENTITY_AUDIT_LOG(
  ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (  
		    START WITH +1  
		    INCREMENT BY +1  
		    MINVALUE +1  
		    MAXVALUE +9223372036854775807  
		    NO CYCLE  
		    CACHE 20  
		    NO ORDER ),
  TIMESTAMP NUMERIC(19,0) NOT NULL,
  ACTION VARCHAR(10) NOT NULL,
  ACTOR_ID NUMERIC(19,0) NOT NULL,
  ACTOR NVARCHAR(130) NOT NULL,
  ENTITY_TYPE CHAR(2) NOT NULL,
  ENTITY_ID NUMERIC(19,0) NOT NULL,
  OLD_VALUE VARCHAR(4000),
  NEW_VALUE VARCHAR(4000),
  CONSTRAINT ENTITY_AUDIT_LOG_PK PRIMARY KEY(
    ID
  ) 
);
CREATE INDEX IDX_ENTITY_AUDIT_4_ACTION
ON ENTITY_AUDIT_LOG (
	ACTION ASC
);
CREATE INDEX IDX_ENTITY_AUDIT_4_ACTOR
ON ENTITY_AUDIT_LOG (
	ACTOR ASC
);
CREATE INDEX IDX_ENTITY_AUDIT_4_TYPE
ON ENTITY_AUDIT_LOG (
	ENTITY_TYPE ASC
);

UPDATE OPERATOR_CONFIG set LABEL='exactly matches' WHERE DATA_TYPE='MULTIVAL' AND OPERATOR_KEY='equals_unordered' AND LABEL='=';
UPDATE OPERATOR_CONFIG set OPERATOR_KEY='=', LABEL='=' WHERE DATA_TYPE='MULTIVAL' AND OPERATOR_KEY='has' AND LABEL='has';
UPDATE OPERATOR_CONFIG set OPERATOR_KEY='!=', LABEL='!=' WHERE DATA_TYPE='MULTIVAL' AND OPERATOR_KEY='does_not_have' AND LABEL='does not have';